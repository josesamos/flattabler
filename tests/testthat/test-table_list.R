test_that("divide() divides a df in a df list", {
  expect_equal({
    divide(ft_set_h_v)
  }, list(
    structure(
      list(
        df = structure(
          list(
            V1 = c(
              "M4",
              "",
              "B",
              "b1",
              "",
              "",
              "",
              "Total b1",
              "b2",
              "",
              "",
              "",
              "",
              "Total b2",
              "b3",
              "",
              "",
              "",
              "Total b3",
              "b4",
              "",
              "",
              "",
              "",
              "Total b4",
              "Total general"
            ),
            V2 = c(
              "",
              "",
              "A",
              "a05",
              "a09",
              "a13",
              "a17",
              "",
              "a02",
              "a06",
              "a10",
              "a14",
              "a18",
              "",
              "a03",
              "a07",
              "a15",
              "a19",
              "",
              "a04",
              "a08",
              "a12",
              "a16",
              "a20",
              "",
              ""
            ),
            V3 = c(
              "E",
              "e2",
              "d3",
              "70,40",
              "674,31",
              "421,08",
              "96,00",
              "1.261,79",
              "924,80",
              "1.058,40",
              "791,04",
              "4.698,00",
              "150,00",
              "7.622,24",
              "658,56",
              "92,00",
              "2.043,00",
              "393,96",
              "3.187,52",
              "263,13",
              "69,66",
              "346,00",
              "1.399,68",
              "34,88",
              "2.113,35",
              "14.184,90"
            ),
            V4 = c(
              "D",
              "",
              "d4",
              "1.089,00",
              "",
              "1.055,12",
              "1.347,84",
              "3.491,96",
              "1.867,02",
              "494,19",
              "121,03",
              "40,96",
              "443,52",
              "2.966,72",
              "203,52",
              "1.466,08",
              "184,96",
              "1.056,25",
              "2.910,81",
              "204,80",
              "1.261,17",
              "1.008,61",
              "142,08",
              "261,95",
              "2.878,61",
              "12.248,10"
            ),
            V5 = c(
              "",
              "",
              "d5",
              "",
              "",
              "64,68",
              "545,28",
              "609,96",
              "73,50",
              "139,65",
              "",
              "",
              "",
              "213,15",
              "148,48",
              "",
              "544,18",
              "",
              "692,66",
              "489,00",
              "101,50",
              "124,74",
              "43,36",
              "83,00",
              "841,60",
              "2.357,37"
            ),
            V6 = c(
              "",
              "Total e2",
              "",
              "1.159,40",
              "674,31",
              "1.540,88",
              "1.989,12",
              "5.363,71",
              "2.865,32",
              "1.692,24",
              "912,07",
              "4.738,96",
              "593,52",
              "10.802,11",
              "1.010,56",
              "1.558,08",
              "2.772,14",
              "1.450,21",
              "6.790,99",
              "956,93",
              "1.432,33",
              "1.479,35",
              "1.585,12",
              "379,83",
              "5.833,56",
              "28.790,37"
            ),
            V7 = c(
              "",
              "Total general",
              "",
              "1.159,40",
              "674,31",
              "1.540,88",
              "1.989,12",
              "5.363,71",
              "2.865,32",
              "1.692,24",
              "912,07",
              "4.738,96",
              "593,52",
              "10.802,11",
              "1.010,56",
              "1.558,08",
              "2.772,14",
              "1.450,21",
              "6.790,99",
              "956,93",
              "1.432,33",
              "1.479,35",
              "1.585,12",
              "379,83",
              "5.833,56",
              "28.790,37"
            )
          ),
          class = "data.frame",
          row.names = c(NA, 26L)
        ),
        page = character(0),
        n_col_labels = 0,
        n_row_labels = 0
      ),
      class = "pivot_table"
    ),
    structure(
      list(
        df = structure(
          list(
            V1 = c(
              "M3",
              "",
              "B",
              "b1",
              "",
              "",
              "",
              "Total b1",
              "b2",
              "",
              "",
              "",
              "",
              "Total b2",
              "b3",
              "",
              "",
              "",
              "",
              "Total b3",
              "b4",
              "",
              "",
              "",
              "",
              "Total b4",
              "Total general"
            ),
            V2 = c(
              "",
              "",
              "A",
              "a05",
              "a09",
              "a13",
              "a17",
              "",
              "a02",
              "a06",
              "a10",
              "a14",
              "a18",
              "",
              "a03",
              "a07",
              "a11",
              "a15",
              "a19",
              "",
              "a04",
              "a08",
              "a12",
              "a16",
              "a20",
              "",
              ""
            ),
            V3 = c(
              "E",
              "e1",
              "d1",
              "78,31",
              "40,80",
              "35,88",
              "33,39",
              "188,38",
              "25,60",
              "63,60",
              "9,90",
              "40,32",
              "44,80",
              "184,22",
              "12,96",
              "13,98",
              "23,17",
              "42,98",
              "47,15",
              "140,24",
              "16,56",
              "30,42",
              "",
              "14,30",
              "43,20",
              "104,48",
              "617,32"
            ),
            V4 = c(
              "D",
              "",
              "d2",
              "",
              "32,88",
              "12,24",
              "44,62",
              "89,74",
              "45,10",
              "30,30",
              "25,11",
              "25,68",
              "27,20",
              "153,39",
              "26,70",
              "",
              "17,75",
              "",
              "53,77",
              "98,22",
              "24,16",
              "15,15",
              "47,04",
              "35,46",
              "",
              "121,81",
              "463,16"
            ),
            V5 = c(
              "",
              "Total e1",
              "",
              "78,31",
              "73,68",
              "48,12",
              "78,01",
              "278,12",
              "70,70",
              "93,90",
              "35,01",
              "66,00",
              "72,00",
              "337,61",
              "39,66",
              "13,98",
              "40,92",
              "42,98",
              "100,92",
              "238,46",
              "40,72",
              "45,57",
              "47,04",
              "49,76",
              "43,20",
              "226,29",
              "1.080,48"
            ),
            V6 = c(
              "",
              "Total general",
              "",
              "78,31",
              "73,68",
              "48,12",
              "78,01",
              "278,12",
              "70,70",
              "93,90",
              "35,01",
              "66,00",
              "72,00",
              "337,61",
              "39,66",
              "13,98",
              "40,92",
              "42,98",
              "100,92",
              "238,46",
              "40,72",
              "45,57",
              "47,04",
              "49,76",
              "43,20",
              "226,29",
              "1.080,48"
            )
          ),
          class = "data.frame",
          row.names = c(NA,
                        27L)
        ),
        page = character(0),
        n_col_labels = 0,
        n_row_labels = 0
      ),
      class = "pivot_table"
    ),
    structure(
      list(
        df = structure(
          list(
            V1 = c(
              "M2",
              "",
              "B",
              "b1",
              "",
              "",
              "",
              "",
              "Total b1",
              "b2",
              "",
              "",
              "",
              "",
              "Total b2",
              "b3",
              "",
              "",
              "",
              "",
              "Total b3",
              "b4",
              "",
              "",
              "",
              "",
              "Total b4",
              "Total general"
            ),
            V2 = c(
              "",
              "",
              "A",
              "a01",
              "a05",
              "a09",
              "a13",
              "a17",
              "",
              "a02",
              "a06",
              "a10",
              "a14",
              "a18",
              "",
              "a03",
              "a07",
              "a11",
              "a15",
              "a19",
              "",
              "a04",
              "a08",
              "a12",
              "a16",
              "a20",
              "",
              ""
            ),
            V3 = c(
              "E",
              "e1",
              "d1",
              "",
              "41",
              "16",
              "12",
              "9",
              "78",
              "10",
              "24",
              "6",
              "32",
              "20",
              "92",
              "4",
              "6",
              "7",
              "14",
              "23",
              "54",
              "9",
              "18",
              "",
              "10",
              "16",
              "53",
              "277"
            ),
            V4 = c(
              "D",
              "",
              "d2",
              "",
              "",
              "12",
              "12",
              "23",
              "47",
              "10",
              "15",
              "27",
              "8",
              "10",
              "70",
              "10",
              "",
              "5",
              "",
              "19",
              "34",
              "16",
              "15",
              "32",
              "18",
              "",
              "81",
              "232"
            ),
            V5 = c(
              "",
              "Total e1",
              "",
              "",
              "41",
              "28",
              "24",
              "32",
              "125",
              "20",
              "39",
              "33",
              "40",
              "30",
              "162",
              "14",
              "6",
              "12",
              "14",
              "42",
              "88",
              "25",
              "33",
              "32",
              "28",
              "16",
              "134",
              "509"
            ),
            V6 = c(
              "",
              "e2",
              "d3",
              "",
              "8",
              "13",
              "11",
              "5",
              "37",
              "34",
              "21",
              "16",
              "45",
              "10",
              "126",
              "14",
              "5",
              "17",
              "30",
              "14",
              "80",
              "7",
              "9",
              "10",
              "24",
              "4",
              "54",
              "297"
            ),
            V7 = c(
              "",
              "",
              "d4",
              "9",
              "22",
              "",
              "22",
              "24",
              "77",
              "29",
              "17",
              "7",
              "4",
              "12",
              "69",
              "8",
              "28",
              "",
              "17",
              "25",
              "78",
              "8",
              "27",
              "17",
              "8",
              "13",
              "73",
              "297"
            ),
            V8 = c(
              "",
              "",
              "d5",
              "",
              "",
              "",
              "7",
              "16",
              "23",
              "5",
              "7",
              "",
              "",
              "",
              "12",
              "8",
              "",
              "13",
              "13",
              "",
              "34",
              "10",
              "5",
              "9",
              "4",
              "5",
              "33",
              "102"
            ),
            V9 = c(
              "",
              "Total e2",
              "",
              "9",
              "30",
              "13",
              "40",
              "45",
              "137",
              "68",
              "45",
              "23",
              "49",
              "22",
              "207",
              "30",
              "33",
              "30",
              "60",
              "39",
              "192",
              "25",
              "41",
              "36",
              "36",
              "22",
              "160",
              "696"
            ),
            V10 = c(
              "",
              "Total general",
              "",
              "9",
              "71",
              "41",
              "64",
              "77",
              "262",
              "88",
              "84",
              "56",
              "89",
              "52",
              "369",
              "44",
              "39",
              "42",
              "74",
              "81",
              "280",
              "50",
              "74",
              "68",
              "64",
              "38",
              "294",
              "1205"
            )
          ),
          class = "data.frame",
          row.names = c(NA,
                        28L)
        ),
        page = character(0),
        n_col_labels = 0,
        n_row_labels = 0
      ),
      class = "pivot_table"
    ),
    structure(
      list(
        df = structure(
          list(
            V1 = c(
              "M1",
              "",
              "B",
              "b1",
              "",
              "",
              "",
              "",
              "Total b1",
              "b4",
              "",
              "",
              "",
              "",
              "Total b4",
              "Total general"
            ),
            V2 = c(
              "",
              "",
              "A",
              "a01",
              "a05",
              "a09",
              "a13",
              "a17",
              "",
              "a04",
              "a08",
              "a12",
              "a16",
              "a20",
              "",
              ""
            ),
            V3 = c(
              "E",
              "e1",
              "d1",
              "",
              "1,91 ",
              "2,55 ",
              "2,99 ",
              "3,71 ",
              "11,16 ",
              "1,84 ",
              "1,69 ",
              "",
              "1,43 ",
              "2,70 ",
              "7,66 ",
              "18,82 "
            ),
            V4 = c(
              "D",
              "",
              "d2",
              "",
              "",
              "2,74 ",
              "1,02 ",
              "1,94 ",
              "5,70 ",
              "1,51 ",
              "1,01 ",
              "1,47 ",
              "1,97 ",
              "",
              "5,96 ",
              "11,66 "
            ),
            V5 = c(
              "",
              "Total e1",
              "",
              "",
              "1,91 ",
              "5,29 ",
              "4,01 ",
              "5,65 ",
              "16,86 ",
              "3,35 ",
              "2,70 ",
              "1,47 ",
              "3,40 ",
              "2,70 ",
              "13,62 ",
              "30,48 "
            ),
            V6 = c(
              "",
              "e2",
              "d3",
              "",
              "1,10 ",
              "3,99 ",
              "3,48 ",
              "3,84 ",
              "12,41 ",
              "5,37 ",
              "0,86 ",
              "3,46 ",
              "2,43 ",
              "2,18 ",
              "14,30 ",
              "26,71 "
            ),
            V7 = c(
              "",
              "",
              "d4",
              "1,88 ",
              "2,25 ",
              "",
              "2,18 ",
              "2,34 ",
              "8,65 ",
              "3,20 ",
              "1,73 ",
              "3,49 ",
              "2,22 ",
              "1,55 ",
              "12,19 ",
              "20,84 "
            ),
            V8 = c(
              "",
              "",
              "d5",
              "",
              "",
              "",
              "1,32 ",
              "2,13 ",
              "3,45 ",
              "4,89 ",
              "4,06 ",
              "1,54 ",
              "2,71 ",
              "3,32 ",
              "16,52 ",
              "19,97 "
            ),
            V9 = c(
              "",
              "Total e2",
              "",
              "1,88 ",
              "3,35 ",
              "3,99 ",
              "6,98 ",
              "8,31 ",
              "24,51 ",
              "13,46 ",
              "6,65 ",
              "8,49 ",
              "7,36 ",
              "7,05 ",
              "43,01 ",
              "67,52 "
            ),
            V10 = c(
              "",
              "Total general",
              "",
              "1,88 ",
              "5,26 ",
              "9,28 ",
              "10,99 ",
              "13,96 ",
              "41,37 ",
              "16,81 ",
              "9,35 ",
              "9,96 ",
              "10,76 ",
              "9,75 ",
              "56,63 ",
              "98,00 "
            )
          ),
          class = "data.frame",
          row.names = c(NA, 16L)
        ),
        page = character(0),
        n_col_labels = 0,
        n_row_labels = 0
      ),
      class = "pivot_table"
    )
  ))
})

test_that("divide() divides a df in a df list", {
  expect_equal({
    divide(ft_set_h)
  }, list(
    structure(
      list(
        df = structure(
          list(
            V1 = c(
              "M4",
              "",
              "B",
              "b1",
              "",
              "",
              "",
              "Total b1",
              "b2",
              "",
              "",
              "",
              "",
              "Total b2",
              "b3",
              "",
              "",
              "",
              "Total b3",
              "b4",
              "",
              "",
              "",
              "",
              "Total b4",
              "Total general"
            ),
            V2 = c(
              "",
              "",
              "A",
              "a05",
              "a09",
              "a13",
              "a17",
              "",
              "a02",
              "a06",
              "a10",
              "a14",
              "a18",
              "",
              "a03",
              "a07",
              "a15",
              "a19",
              "",
              "a04",
              "a08",
              "a12",
              "a16",
              "a20",
              "",
              ""
            ),
            V3 = c(
              "E",
              "e2",
              "d3",
              "70,40",
              "674,31",
              "421,08",
              "96,00",
              "1.261,79",
              "924,80",
              "1.058,40",
              "791,04",
              "4.698,00",
              "150,00",
              "7.622,24",
              "658,56",
              "92,00",
              "2.043,00",
              "393,96",
              "3.187,52",
              "263,13",
              "69,66",
              "346,00",
              "1.399,68",
              "34,88",
              "2.113,35",
              "14.184,90"
            ),
            V4 = c(
              "D",
              "",
              "d4",
              "1.089,00",
              "",
              "1.055,12",
              "1.347,84",
              "3.491,96",
              "1.867,02",
              "494,19",
              "121,03",
              "40,96",
              "443,52",
              "2.966,72",
              "203,52",
              "1.466,08",
              "184,96",
              "1.056,25",
              "2.910,81",
              "204,80",
              "1.261,17",
              "1.008,61",
              "142,08",
              "261,95",
              "2.878,61",
              "12.248,10"
            ),
            V5 = c(
              "",
              "",
              "d5",
              "",
              "",
              "64,68",
              "545,28",
              "609,96",
              "73,50",
              "139,65",
              "",
              "",
              "",
              "213,15",
              "148,48",
              "",
              "544,18",
              "",
              "692,66",
              "489,00",
              "101,50",
              "124,74",
              "43,36",
              "83,00",
              "841,60",
              "2.357,37"
            ),
            V6 = c(
              "",
              "Total e2",
              "",
              "1.159,40",
              "674,31",
              "1.540,88",
              "1.989,12",
              "5.363,71",
              "2.865,32",
              "1.692,24",
              "912,07",
              "4.738,96",
              "593,52",
              "10.802,11",
              "1.010,56",
              "1.558,08",
              "2.772,14",
              "1.450,21",
              "6.790,99",
              "956,93",
              "1.432,33",
              "1.479,35",
              "1.585,12",
              "379,83",
              "5.833,56",
              "28.790,37"
            ),
            V7 = c(
              "",
              "Total general",
              "",
              "1.159,40",
              "674,31",
              "1.540,88",
              "1.989,12",
              "5.363,71",
              "2.865,32",
              "1.692,24",
              "912,07",
              "4.738,96",
              "593,52",
              "10.802,11",
              "1.010,56",
              "1.558,08",
              "2.772,14",
              "1.450,21",
              "6.790,99",
              "956,93",
              "1.432,33",
              "1.479,35",
              "1.585,12",
              "379,83",
              "5.833,56",
              "28.790,37"
            )
          ),
          class = "data.frame",
          row.names = c(NA, 26L)
        ),
        page = character(0),
        n_col_labels = 0,
        n_row_labels = 0
      ),
      class = "pivot_table"
    ),
    structure(
      list(
        df = structure(
          list(
            V1 = c(
              "M3",
              "",
              "B",
              "b1",
              "",
              "",
              "",
              "Total b1",
              "b2",
              "",
              "",
              "",
              "",
              "Total b2",
              "b3",
              "",
              "",
              "",
              "",
              "Total b3",
              "b4",
              "",
              "",
              "",
              "",
              "Total b4",
              "Total general"
            ),
            V2 = c(
              "",
              "",
              "A",
              "a05",
              "a09",
              "a13",
              "a17",
              "",
              "a02",
              "a06",
              "a10",
              "a14",
              "a18",
              "",
              "a03",
              "a07",
              "a11",
              "a15",
              "a19",
              "",
              "a04",
              "a08",
              "a12",
              "a16",
              "a20",
              "",
              ""
            ),
            V3 = c(
              "E",
              "e1",
              "d1",
              "78,31",
              "40,80",
              "35,88",
              "33,39",
              "188,38",
              "25,60",
              "63,60",
              "9,90",
              "40,32",
              "44,80",
              "184,22",
              "12,96",
              "13,98",
              "23,17",
              "42,98",
              "47,15",
              "140,24",
              "16,56",
              "30,42",
              "",
              "14,30",
              "43,20",
              "104,48",
              "617,32"
            ),
            V4 = c(
              "D",
              "",
              "d2",
              "",
              "32,88",
              "12,24",
              "44,62",
              "89,74",
              "45,10",
              "30,30",
              "25,11",
              "25,68",
              "27,20",
              "153,39",
              "26,70",
              "",
              "17,75",
              "",
              "53,77",
              "98,22",
              "24,16",
              "15,15",
              "47,04",
              "35,46",
              "",
              "121,81",
              "463,16"
            ),
            V5 = c(
              "",
              "Total e1",
              "",
              "78,31",
              "73,68",
              "48,12",
              "78,01",
              "278,12",
              "70,70",
              "93,90",
              "35,01",
              "66,00",
              "72,00",
              "337,61",
              "39,66",
              "13,98",
              "40,92",
              "42,98",
              "100,92",
              "238,46",
              "40,72",
              "45,57",
              "47,04",
              "49,76",
              "43,20",
              "226,29",
              "1.080,48"
            ),
            V6 = c(
              "",
              "Total general",
              "",
              "78,31",
              "73,68",
              "48,12",
              "78,01",
              "278,12",
              "70,70",
              "93,90",
              "35,01",
              "66,00",
              "72,00",
              "337,61",
              "39,66",
              "13,98",
              "40,92",
              "42,98",
              "100,92",
              "238,46",
              "40,72",
              "45,57",
              "47,04",
              "49,76",
              "43,20",
              "226,29",
              "1.080,48"
            )
          ),
          class = "data.frame",
          row.names = c(NA,
                        27L)
        ),
        page = character(0),
        n_col_labels = 0,
        n_row_labels = 0
      ),
      class = "pivot_table"
    ),
    structure(
      list(
        df = structure(
          list(
            V1 = c(
              "M2",
              "",
              "B",
              "b1",
              "",
              "",
              "",
              "",
              "Total b1",
              "b2",
              "",
              "",
              "",
              "",
              "Total b2",
              "b3",
              "",
              "",
              "",
              "",
              "Total b3",
              "b4",
              "",
              "",
              "",
              "",
              "Total b4",
              "Total general"
            ),
            V2 = c(
              "",
              "",
              "A",
              "a01",
              "a05",
              "a09",
              "a13",
              "a17",
              "",
              "a02",
              "a06",
              "a10",
              "a14",
              "a18",
              "",
              "a03",
              "a07",
              "a11",
              "a15",
              "a19",
              "",
              "a04",
              "a08",
              "a12",
              "a16",
              "a20",
              "",
              ""
            ),
            V3 = c(
              "E",
              "e1",
              "d1",
              "",
              "41",
              "16",
              "12",
              "9",
              "78",
              "10",
              "24",
              "6",
              "32",
              "20",
              "92",
              "4",
              "6",
              "7",
              "14",
              "23",
              "54",
              "9",
              "18",
              "",
              "10",
              "16",
              "53",
              "277"
            ),
            V4 = c(
              "D",
              "",
              "d2",
              "",
              "",
              "12",
              "12",
              "23",
              "47",
              "10",
              "15",
              "27",
              "8",
              "10",
              "70",
              "10",
              "",
              "5",
              "",
              "19",
              "34",
              "16",
              "15",
              "32",
              "18",
              "",
              "81",
              "232"
            ),
            V5 = c(
              "",
              "Total e1",
              "",
              "",
              "41",
              "28",
              "24",
              "32",
              "125",
              "20",
              "39",
              "33",
              "40",
              "30",
              "162",
              "14",
              "6",
              "12",
              "14",
              "42",
              "88",
              "25",
              "33",
              "32",
              "28",
              "16",
              "134",
              "509"
            ),
            V6 = c(
              "",
              "e2",
              "d3",
              "",
              "8",
              "13",
              "11",
              "5",
              "37",
              "34",
              "21",
              "16",
              "45",
              "10",
              "126",
              "14",
              "5",
              "17",
              "30",
              "14",
              "80",
              "7",
              "9",
              "10",
              "24",
              "4",
              "54",
              "297"
            ),
            V7 = c(
              "",
              "",
              "d4",
              "9",
              "22",
              "",
              "22",
              "24",
              "77",
              "29",
              "17",
              "7",
              "4",
              "12",
              "69",
              "8",
              "28",
              "",
              "17",
              "25",
              "78",
              "8",
              "27",
              "17",
              "8",
              "13",
              "73",
              "297"
            ),
            V8 = c(
              "",
              "",
              "d5",
              "",
              "",
              "",
              "7",
              "16",
              "23",
              "5",
              "7",
              "",
              "",
              "",
              "12",
              "8",
              "",
              "13",
              "13",
              "",
              "34",
              "10",
              "5",
              "9",
              "4",
              "5",
              "33",
              "102"
            ),
            V9 = c(
              "",
              "Total e2",
              "",
              "9",
              "30",
              "13",
              "40",
              "45",
              "137",
              "68",
              "45",
              "23",
              "49",
              "22",
              "207",
              "30",
              "33",
              "30",
              "60",
              "39",
              "192",
              "25",
              "41",
              "36",
              "36",
              "22",
              "160",
              "696"
            ),
            V10 = c(
              "",
              "Total general",
              "",
              "9",
              "71",
              "41",
              "64",
              "77",
              "262",
              "88",
              "84",
              "56",
              "89",
              "52",
              "369",
              "44",
              "39",
              "42",
              "74",
              "81",
              "280",
              "50",
              "74",
              "68",
              "64",
              "38",
              "294",
              "1205"
            )
          ),
          class = "data.frame",
          row.names = c(NA,
                        28L)
        ),
        page = character(0),
        n_col_labels = 0,
        n_row_labels = 0
      ),
      class = "pivot_table"
    ),
    structure(
      list(
        df = structure(
          list(
            V1 = c(
              "M1",
              "",
              "B",
              "b1",
              "",
              "",
              "",
              "",
              "Total b1",
              "b4",
              "",
              "",
              "",
              "",
              "Total b4",
              "Total general"
            ),
            V2 = c(
              "",
              "",
              "A",
              "a01",
              "a05",
              "a09",
              "a13",
              "a17",
              "",
              "a04",
              "a08",
              "a12",
              "a16",
              "a20",
              "",
              ""
            ),
            V3 = c(
              "E",
              "e1",
              "d1",
              "",
              "1,91 ",
              "2,55 ",
              "2,99 ",
              "3,71 ",
              "11,16 ",
              "1,84 ",
              "1,69 ",
              "",
              "1,43 ",
              "2,70 ",
              "7,66 ",
              "18,82 "
            ),
            V4 = c(
              "D",
              "",
              "d2",
              "",
              "",
              "2,74 ",
              "1,02 ",
              "1,94 ",
              "5,70 ",
              "1,51 ",
              "1,01 ",
              "1,47 ",
              "1,97 ",
              "",
              "5,96 ",
              "11,66 "
            ),
            V5 = c(
              "",
              "Total e1",
              "",
              "",
              "1,91 ",
              "5,29 ",
              "4,01 ",
              "5,65 ",
              "16,86 ",
              "3,35 ",
              "2,70 ",
              "1,47 ",
              "3,40 ",
              "2,70 ",
              "13,62 ",
              "30,48 "
            ),
            V6 = c(
              "",
              "e2",
              "d3",
              "",
              "1,10 ",
              "3,99 ",
              "3,48 ",
              "3,84 ",
              "12,41 ",
              "5,37 ",
              "0,86 ",
              "3,46 ",
              "2,43 ",
              "2,18 ",
              "14,30 ",
              "26,71 "
            ),
            V7 = c(
              "",
              "",
              "d4",
              "1,88 ",
              "2,25 ",
              "",
              "2,18 ",
              "2,34 ",
              "8,65 ",
              "3,20 ",
              "1,73 ",
              "3,49 ",
              "2,22 ",
              "1,55 ",
              "12,19 ",
              "20,84 "
            ),
            V8 = c(
              "",
              "",
              "d5",
              "",
              "",
              "",
              "1,32 ",
              "2,13 ",
              "3,45 ",
              "4,89 ",
              "4,06 ",
              "1,54 ",
              "2,71 ",
              "3,32 ",
              "16,52 ",
              "19,97 "
            ),
            V9 = c(
              "",
              "Total e2",
              "",
              "1,88 ",
              "3,35 ",
              "3,99 ",
              "6,98 ",
              "8,31 ",
              "24,51 ",
              "13,46 ",
              "6,65 ",
              "8,49 ",
              "7,36 ",
              "7,05 ",
              "43,01 ",
              "67,52 "
            ),
            V10 = c(
              "",
              "Total general",
              "",
              "1,88 ",
              "5,26 ",
              "9,28 ",
              "10,99 ",
              "13,96 ",
              "41,37 ",
              "16,81 ",
              "9,35 ",
              "9,96 ",
              "10,76 ",
              "9,75 ",
              "56,63 ",
              "98,00 "
            )
          ),
          class = "data.frame",
          row.names = c(NA, 16L)
        ),
        page = character(0),
        n_col_labels = 0,
        n_row_labels = 0
      ),
      class = "pivot_table"
    )
  ))
})

test_that("divide() divides a df in a df list", {
  expect_equal({
    divide(ft_set_v)
  }, list(
    structure(
      list(
        df = structure(
          list(
            V1 = c(
              "M4",
              "",
              "B",
              "b1",
              "",
              "",
              "",
              "Total b1",
              "b2",
              "",
              "",
              "",
              "",
              "Total b2",
              "b3",
              "",
              "",
              "",
              "Total b3",
              "b4",
              "",
              "",
              "",
              "",
              "Total b4",
              "Total general"
            ),
            V2 = c(
              "",
              "",
              "A",
              "a05",
              "a09",
              "a13",
              "a17",
              "",
              "a02",
              "a06",
              "a10",
              "a14",
              "a18",
              "",
              "a03",
              "a07",
              "a15",
              "a19",
              "",
              "a04",
              "a08",
              "a12",
              "a16",
              "a20",
              "",
              ""
            ),
            V3 = c(
              "E",
              "e2",
              "d3",
              "70,40",
              "674,31",
              "421,08",
              "96,00",
              "1.261,79",
              "924,80",
              "1.058,40",
              "791,04",
              "4.698,00",
              "150,00",
              "7.622,24",
              "658,56",
              "92,00",
              "2.043,00",
              "393,96",
              "3.187,52",
              "263,13",
              "69,66",
              "346,00",
              "1.399,68",
              "34,88",
              "2.113,35",
              "14.184,90"
            ),
            V4 = c(
              "D",
              "",
              "d4",
              "1.089,00",
              "",
              "1.055,12",
              "1.347,84",
              "3.491,96",
              "1.867,02",
              "494,19",
              "121,03",
              "40,96",
              "443,52",
              "2.966,72",
              "203,52",
              "1.466,08",
              "184,96",
              "1.056,25",
              "2.910,81",
              "204,80",
              "1.261,17",
              "1.008,61",
              "142,08",
              "261,95",
              "2.878,61",
              "12.248,10"
            ),
            V5 = c(
              "",
              "",
              "d5",
              "",
              "",
              "64,68",
              "545,28",
              "609,96",
              "73,50",
              "139,65",
              "",
              "",
              "",
              "213,15",
              "148,48",
              "",
              "544,18",
              "",
              "692,66",
              "489,00",
              "101,50",
              "124,74",
              "43,36",
              "83,00",
              "841,60",
              "2.357,37"
            ),
            V6 = c(
              "",
              "Total e2",
              "",
              "1.159,40",
              "674,31",
              "1.540,88",
              "1.989,12",
              "5.363,71",
              "2.865,32",
              "1.692,24",
              "912,07",
              "4.738,96",
              "593,52",
              "10.802,11",
              "1.010,56",
              "1.558,08",
              "2.772,14",
              "1.450,21",
              "6.790,99",
              "956,93",
              "1.432,33",
              "1.479,35",
              "1.585,12",
              "379,83",
              "5.833,56",
              "28.790,37"
            ),
            V7 = c(
              "",
              "Total general",
              "",
              "1.159,40",
              "674,31",
              "1.540,88",
              "1.989,12",
              "5.363,71",
              "2.865,32",
              "1.692,24",
              "912,07",
              "4.738,96",
              "593,52",
              "10.802,11",
              "1.010,56",
              "1.558,08",
              "2.772,14",
              "1.450,21",
              "6.790,99",
              "956,93",
              "1.432,33",
              "1.479,35",
              "1.585,12",
              "379,83",
              "5.833,56",
              "28.790,37"
            )
          ),
          class = "data.frame",
          row.names = c(NA, 26L)
        ),
        page = character(0),
        n_col_labels = 0,
        n_row_labels = 0
      ),
      class = "pivot_table"
    ),
    structure(
      list(
        df = structure(
          list(
            V1 = c(
              "M3",
              "",
              "B",
              "b1",
              "",
              "",
              "",
              "Total b1",
              "b2",
              "",
              "",
              "",
              "",
              "Total b2",
              "b3",
              "",
              "",
              "",
              "",
              "Total b3",
              "b4",
              "",
              "",
              "",
              "",
              "Total b4",
              "Total general"
            ),
            V2 = c(
              "",
              "",
              "A",
              "a05",
              "a09",
              "a13",
              "a17",
              "",
              "a02",
              "a06",
              "a10",
              "a14",
              "a18",
              "",
              "a03",
              "a07",
              "a11",
              "a15",
              "a19",
              "",
              "a04",
              "a08",
              "a12",
              "a16",
              "a20",
              "",
              ""
            ),
            V3 = c(
              "E",
              "e1",
              "d1",
              "78,31",
              "40,80",
              "35,88",
              "33,39",
              "188,38",
              "25,60",
              "63,60",
              "9,90",
              "40,32",
              "44,80",
              "184,22",
              "12,96",
              "13,98",
              "23,17",
              "42,98",
              "47,15",
              "140,24",
              "16,56",
              "30,42",
              "",
              "14,30",
              "43,20",
              "104,48",
              "617,32"
            ),
            V4 = c(
              "D",
              "",
              "d2",
              "",
              "32,88",
              "12,24",
              "44,62",
              "89,74",
              "45,10",
              "30,30",
              "25,11",
              "25,68",
              "27,20",
              "153,39",
              "26,70",
              "",
              "17,75",
              "",
              "53,77",
              "98,22",
              "24,16",
              "15,15",
              "47,04",
              "35,46",
              "",
              "121,81",
              "463,16"
            ),
            V5 = c(
              "",
              "Total e1",
              "",
              "78,31",
              "73,68",
              "48,12",
              "78,01",
              "278,12",
              "70,70",
              "93,90",
              "35,01",
              "66,00",
              "72,00",
              "337,61",
              "39,66",
              "13,98",
              "40,92",
              "42,98",
              "100,92",
              "238,46",
              "40,72",
              "45,57",
              "47,04",
              "49,76",
              "43,20",
              "226,29",
              "1.080,48"
            ),
            V6 = c(
              "",
              "Total general",
              "",
              "78,31",
              "73,68",
              "48,12",
              "78,01",
              "278,12",
              "70,70",
              "93,90",
              "35,01",
              "66,00",
              "72,00",
              "337,61",
              "39,66",
              "13,98",
              "40,92",
              "42,98",
              "100,92",
              "238,46",
              "40,72",
              "45,57",
              "47,04",
              "49,76",
              "43,20",
              "226,29",
              "1.080,48"
            )
          ),
          class = "data.frame",
          row.names = c(NA,
                        27L)
        ),
        page = character(0),
        n_col_labels = 0,
        n_row_labels = 0
      ),
      class = "pivot_table"
    ),
    structure(
      list(
        df = structure(
          list(
            V1 = c(
              "M2",
              "",
              "B",
              "b1",
              "",
              "",
              "",
              "",
              "Total b1",
              "b2",
              "",
              "",
              "",
              "",
              "Total b2",
              "b3",
              "",
              "",
              "",
              "",
              "Total b3",
              "b4",
              "",
              "",
              "",
              "",
              "Total b4",
              "Total general"
            ),
            V2 = c(
              "",
              "",
              "A",
              "a01",
              "a05",
              "a09",
              "a13",
              "a17",
              "",
              "a02",
              "a06",
              "a10",
              "a14",
              "a18",
              "",
              "a03",
              "a07",
              "a11",
              "a15",
              "a19",
              "",
              "a04",
              "a08",
              "a12",
              "a16",
              "a20",
              "",
              ""
            ),
            V3 = c(
              "E",
              "e1",
              "d1",
              "",
              "41",
              "16",
              "12",
              "9",
              "78",
              "10",
              "24",
              "6",
              "32",
              "20",
              "92",
              "4",
              "6",
              "7",
              "14",
              "23",
              "54",
              "9",
              "18",
              "",
              "10",
              "16",
              "53",
              "277"
            ),
            V4 = c(
              "D",
              "",
              "d2",
              "",
              "",
              "12",
              "12",
              "23",
              "47",
              "10",
              "15",
              "27",
              "8",
              "10",
              "70",
              "10",
              "",
              "5",
              "",
              "19",
              "34",
              "16",
              "15",
              "32",
              "18",
              "",
              "81",
              "232"
            ),
            V5 = c(
              "",
              "Total e1",
              "",
              "",
              "41",
              "28",
              "24",
              "32",
              "125",
              "20",
              "39",
              "33",
              "40",
              "30",
              "162",
              "14",
              "6",
              "12",
              "14",
              "42",
              "88",
              "25",
              "33",
              "32",
              "28",
              "16",
              "134",
              "509"
            ),
            V6 = c(
              "",
              "e2",
              "d3",
              "",
              "8",
              "13",
              "11",
              "5",
              "37",
              "34",
              "21",
              "16",
              "45",
              "10",
              "126",
              "14",
              "5",
              "17",
              "30",
              "14",
              "80",
              "7",
              "9",
              "10",
              "24",
              "4",
              "54",
              "297"
            ),
            V7 = c(
              "",
              "",
              "d4",
              "9",
              "22",
              "",
              "22",
              "24",
              "77",
              "29",
              "17",
              "7",
              "4",
              "12",
              "69",
              "8",
              "28",
              "",
              "17",
              "25",
              "78",
              "8",
              "27",
              "17",
              "8",
              "13",
              "73",
              "297"
            ),
            V8 = c(
              "",
              "",
              "d5",
              "",
              "",
              "",
              "7",
              "16",
              "23",
              "5",
              "7",
              "",
              "",
              "",
              "12",
              "8",
              "",
              "13",
              "13",
              "",
              "34",
              "10",
              "5",
              "9",
              "4",
              "5",
              "33",
              "102"
            ),
            V9 = c(
              "",
              "Total e2",
              "",
              "9",
              "30",
              "13",
              "40",
              "45",
              "137",
              "68",
              "45",
              "23",
              "49",
              "22",
              "207",
              "30",
              "33",
              "30",
              "60",
              "39",
              "192",
              "25",
              "41",
              "36",
              "36",
              "22",
              "160",
              "696"
            ),
            V10 = c(
              "",
              "Total general",
              "",
              "9",
              "71",
              "41",
              "64",
              "77",
              "262",
              "88",
              "84",
              "56",
              "89",
              "52",
              "369",
              "44",
              "39",
              "42",
              "74",
              "81",
              "280",
              "50",
              "74",
              "68",
              "64",
              "38",
              "294",
              "1205"
            )
          ),
          class = "data.frame",
          row.names = c(NA,
                        28L)
        ),
        page = character(0),
        n_col_labels = 0,
        n_row_labels = 0
      ),
      class = "pivot_table"
    ),
    structure(
      list(
        df = structure(
          list(
            V1 = c(
              "M1",
              "",
              "B",
              "b1",
              "",
              "",
              "",
              "",
              "Total b1",
              "b4",
              "",
              "",
              "",
              "",
              "Total b4",
              "Total general"
            ),
            V2 = c(
              "",
              "",
              "A",
              "a01",
              "a05",
              "a09",
              "a13",
              "a17",
              "",
              "a04",
              "a08",
              "a12",
              "a16",
              "a20",
              "",
              ""
            ),
            V3 = c(
              "E",
              "e1",
              "d1",
              "",
              "1,91 ",
              "2,55 ",
              "2,99 ",
              "3,71 ",
              "11,16 ",
              "1,84 ",
              "1,69 ",
              "",
              "1,43 ",
              "2,70 ",
              "7,66 ",
              "18,82 "
            ),
            V4 = c(
              "D",
              "",
              "d2",
              "",
              "",
              "2,74 ",
              "1,02 ",
              "1,94 ",
              "5,70 ",
              "1,51 ",
              "1,01 ",
              "1,47 ",
              "1,97 ",
              "",
              "5,96 ",
              "11,66 "
            ),
            V5 = c(
              "",
              "Total e1",
              "",
              "",
              "1,91 ",
              "5,29 ",
              "4,01 ",
              "5,65 ",
              "16,86 ",
              "3,35 ",
              "2,70 ",
              "1,47 ",
              "3,40 ",
              "2,70 ",
              "13,62 ",
              "30,48 "
            ),
            V6 = c(
              "",
              "e2",
              "d3",
              "",
              "1,10 ",
              "3,99 ",
              "3,48 ",
              "3,84 ",
              "12,41 ",
              "5,37 ",
              "0,86 ",
              "3,46 ",
              "2,43 ",
              "2,18 ",
              "14,30 ",
              "26,71 "
            ),
            V7 = c(
              "",
              "",
              "d4",
              "1,88 ",
              "2,25 ",
              "",
              "2,18 ",
              "2,34 ",
              "8,65 ",
              "3,20 ",
              "1,73 ",
              "3,49 ",
              "2,22 ",
              "1,55 ",
              "12,19 ",
              "20,84 "
            ),
            V8 = c(
              "",
              "",
              "d5",
              "",
              "",
              "",
              "1,32 ",
              "2,13 ",
              "3,45 ",
              "4,89 ",
              "4,06 ",
              "1,54 ",
              "2,71 ",
              "3,32 ",
              "16,52 ",
              "19,97 "
            ),
            V9 = c(
              "",
              "Total e2",
              "",
              "1,88 ",
              "3,35 ",
              "3,99 ",
              "6,98 ",
              "8,31 ",
              "24,51 ",
              "13,46 ",
              "6,65 ",
              "8,49 ",
              "7,36 ",
              "7,05 ",
              "43,01 ",
              "67,52 "
            ),
            V10 = c(
              "",
              "Total general",
              "",
              "1,88 ",
              "5,26 ",
              "9,28 ",
              "10,99 ",
              "13,96 ",
              "41,37 ",
              "16,81 ",
              "9,35 ",
              "9,96 ",
              "10,76 ",
              "9,75 ",
              "56,63 ",
              "98,00 "
            )
          ),
          class = "data.frame",
          row.names = c(NA, 16L)
        ),
        page = character(0),
        n_col_labels = 0,
        n_row_labels = 0
      ),
      class = "pivot_table"
    )
  ))
})

test_that("flatten_table_list() flats a list of pivot tables", {
  expect_equal({
    f <- function(pt) {
      pt |>
        set_page(1, 1) |>
        remove_top(1) |>
        define_labels(n_col = 2, n_row = 2) |>
        remove_k() |>
        replace_dec() |>
        fill_values() |>
        fill_labels() |>
        remove_agg() |>
        unpivot()
    }

    lpt <- divide(ft_set_h_v)
    flatten_table_list(lpt, f)
  }, structure(
    list(
      page = c(
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M4",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M3",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M2",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1",
        "M1"
      ),
      col1 = c(
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b2",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b3",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b1",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4",
        "b4"
      ),
      col2 = c(
        "a05",
        "a05",
        "a09",
        "a13",
        "a13",
        "a13",
        "a17",
        "a17",
        "a17",
        "a02",
        "a02",
        "a02",
        "a06",
        "a06",
        "a06",
        "a10",
        "a10",
        "a14",
        "a14",
        "a18",
        "a18",
        "a03",
        "a03",
        "a03",
        "a07",
        "a07",
        "a15",
        "a15",
        "a15",
        "a19",
        "a19",
        "a04",
        "a04",
        "a04",
        "a08",
        "a08",
        "a08",
        "a12",
        "a12",
        "a12",
        "a16",
        "a16",
        "a16",
        "a20",
        "a20",
        "a20",
        "a05",
        "a09",
        "a09",
        "a13",
        "a13",
        "a17",
        "a17",
        "a02",
        "a02",
        "a06",
        "a06",
        "a10",
        "a10",
        "a14",
        "a14",
        "a18",
        "a18",
        "a03",
        "a03",
        "a07",
        "a11",
        "a11",
        "a15",
        "a19",
        "a19",
        "a04",
        "a04",
        "a08",
        "a08",
        "a12",
        "a16",
        "a16",
        "a20",
        "a01",
        "a05",
        "a05",
        "a05",
        "a09",
        "a09",
        "a09",
        "a13",
        "a13",
        "a13",
        "a13",
        "a13",
        "a17",
        "a17",
        "a17",
        "a17",
        "a17",
        "a02",
        "a02",
        "a02",
        "a02",
        "a02",
        "a06",
        "a06",
        "a06",
        "a06",
        "a06",
        "a10",
        "a10",
        "a10",
        "a10",
        "a14",
        "a14",
        "a14",
        "a14",
        "a18",
        "a18",
        "a18",
        "a18",
        "a03",
        "a03",
        "a03",
        "a03",
        "a03",
        "a07",
        "a07",
        "a07",
        "a11",
        "a11",
        "a11",
        "a11",
        "a15",
        "a15",
        "a15",
        "a15",
        "a19",
        "a19",
        "a19",
        "a19",
        "a04",
        "a04",
        "a04",
        "a04",
        "a04",
        "a08",
        "a08",
        "a08",
        "a08",
        "a08",
        "a12",
        "a12",
        "a12",
        "a12",
        "a16",
        "a16",
        "a16",
        "a16",
        "a16",
        "a20",
        "a20",
        "a20",
        "a20",
        "a01",
        "a05",
        "a05",
        "a05",
        "a09",
        "a09",
        "a09",
        "a13",
        "a13",
        "a13",
        "a13",
        "a13",
        "a17",
        "a17",
        "a17",
        "a17",
        "a17",
        "a04",
        "a04",
        "a04",
        "a04",
        "a04",
        "a08",
        "a08",
        "a08",
        "a08",
        "a08",
        "a12",
        "a12",
        "a12",
        "a12",
        "a16",
        "a16",
        "a16",
        "a16",
        "a16",
        "a20",
        "a20",
        "a20",
        "a20"
      ),
      row1 = c(
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e2",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e1",
        "e2",
        "e1",
        "e2",
        "e2",
        "e1",
        "e1",
        "e2",
        "e1",
        "e1",
        "e2",
        "e2",
        "e2",
        "e1",
        "e1",
        "e2",
        "e2",
        "e2",
        "e1",
        "e1",
        "e2",
        "e2",
        "e2",
        "e1",
        "e1",
        "e2",
        "e2",
        "e2",
        "e1",
        "e1",
        "e2",
        "e2",
        "e1",
        "e1",
        "e2",
        "e2",
        "e1",
        "e1",
        "e2",
        "e2",
        "e1",
        "e1",
        "e2",
        "e2",
        "e2",
        "e1",
        "e2",
        "e2",
        "e1",
        "e1",
        "e2",
        "e2",
        "e1",
        "e2",
        "e2",
        "e2",
        "e1",
        "e1",
        "e2",
        "e2",
        "e1",
        "e1",
        "e2",
        "e2",
        "e2",
        "e1",
        "e1",
        "e2",
        "e2",
        "e2",
        "e1",
        "e2",
        "e2",
        "e2",
        "e1",
        "e1",
        "e2",
        "e2",
        "e2",
        "e1",
        "e2",
        "e2",
        "e2",
        "e2",
        "e1",
        "e2",
        "e2",
        "e1",
        "e1",
        "e2",
        "e1",
        "e1",
        "e2",
        "e2",
        "e2",
        "e1",
        "e1",
        "e2",
        "e2",
        "e2",
        "e1",
        "e1",
        "e2",
        "e2",
        "e2",
        "e1",
        "e1",
        "e2",
        "e2",
        "e2",
        "e1",
        "e2",
        "e2",
        "e2",
        "e1",
        "e1",
        "e2",
        "e2",
        "e2",
        "e1",
        "e2",
        "e2",
        "e2"
      ),
      row2 = c(
        "d3",
        "d4",
        "d3",
        "d3",
        "d4",
        "d5",
        "d3",
        "d4",
        "d5",
        "d3",
        "d4",
        "d5",
        "d3",
        "d4",
        "d5",
        "d3",
        "d4",
        "d3",
        "d4",
        "d3",
        "d4",
        "d3",
        "d4",
        "d5",
        "d3",
        "d4",
        "d3",
        "d4",
        "d5",
        "d3",
        "d4",
        "d3",
        "d4",
        "d5",
        "d3",
        "d4",
        "d5",
        "d3",
        "d4",
        "d5",
        "d3",
        "d4",
        "d5",
        "d3",
        "d4",
        "d5",
        "d1",
        "d1",
        "d2",
        "d1",
        "d2",
        "d1",
        "d2",
        "d1",
        "d2",
        "d1",
        "d2",
        "d1",
        "d2",
        "d1",
        "d2",
        "d1",
        "d2",
        "d1",
        "d2",
        "d1",
        "d1",
        "d2",
        "d1",
        "d1",
        "d2",
        "d1",
        "d2",
        "d1",
        "d2",
        "d2",
        "d1",
        "d2",
        "d1",
        "d4",
        "d1",
        "d3",
        "d4",
        "d1",
        "d2",
        "d3",
        "d1",
        "d2",
        "d3",
        "d4",
        "d5",
        "d1",
        "d2",
        "d3",
        "d4",
        "d5",
        "d1",
        "d2",
        "d3",
        "d4",
        "d5",
        "d1",
        "d2",
        "d3",
        "d4",
        "d5",
        "d1",
        "d2",
        "d3",
        "d4",
        "d1",
        "d2",
        "d3",
        "d4",
        "d1",
        "d2",
        "d3",
        "d4",
        "d1",
        "d2",
        "d3",
        "d4",
        "d5",
        "d1",
        "d3",
        "d4",
        "d1",
        "d2",
        "d3",
        "d5",
        "d1",
        "d3",
        "d4",
        "d5",
        "d1",
        "d2",
        "d3",
        "d4",
        "d1",
        "d2",
        "d3",
        "d4",
        "d5",
        "d1",
        "d2",
        "d3",
        "d4",
        "d5",
        "d2",
        "d3",
        "d4",
        "d5",
        "d1",
        "d2",
        "d3",
        "d4",
        "d5",
        "d1",
        "d3",
        "d4",
        "d5",
        "d4",
        "d1",
        "d3",
        "d4",
        "d1",
        "d2",
        "d3",
        "d1",
        "d2",
        "d3",
        "d4",
        "d5",
        "d1",
        "d2",
        "d3",
        "d4",
        "d5",
        "d1",
        "d2",
        "d3",
        "d4",
        "d5",
        "d1",
        "d2",
        "d3",
        "d4",
        "d5",
        "d2",
        "d3",
        "d4",
        "d5",
        "d1",
        "d2",
        "d3",
        "d4",
        "d5",
        "d1",
        "d3",
        "d4",
        "d5"
      ),
      value = c(
        "70.40",
        "1089.00",
        "674.31",
        "421.08",
        "1055.12",
        "64.68",
        "96.00",
        "1347.84",
        "545.28",
        "924.80",
        "1867.02",
        "73.50",
        "1058.40",
        "494.19",
        "139.65",
        "791.04",
        "121.03",
        "4698.00",
        "40.96",
        "150.00",
        "443.52",
        "658.56",
        "203.52",
        "148.48",
        "92.00",
        "1466.08",
        "2043.00",
        "184.96",
        "544.18",
        "393.96",
        "1056.25",
        "263.13",
        "204.80",
        "489.00",
        "69.66",
        "1261.17",
        "101.50",
        "346.00",
        "1008.61",
        "124.74",
        "1399.68",
        "142.08",
        "43.36",
        "34.88",
        "261.95",
        "83.00",
        "78.31",
        "40.80",
        "32.88",
        "35.88",
        "12.24",
        "33.39",
        "44.62",
        "25.60",
        "45.10",
        "63.60",
        "30.30",
        "9.90",
        "25.11",
        "40.32",
        "25.68",
        "44.80",
        "27.20",
        "12.96",
        "26.70",
        "13.98",
        "23.17",
        "17.75",
        "42.98",
        "47.15",
        "53.77",
        "16.56",
        "24.16",
        "30.42",
        "15.15",
        "47.04",
        "14.30",
        "35.46",
        "43.20",
        "9",
        "41",
        "8",
        "22",
        "16",
        "12",
        "13",
        "12",
        "12",
        "11",
        "22",
        "7",
        "9",
        "23",
        "5",
        "24",
        "16",
        "10",
        "10",
        "34",
        "29",
        "5",
        "24",
        "15",
        "21",
        "17",
        "7",
        "6",
        "27",
        "16",
        "7",
        "32",
        "8",
        "45",
        "4",
        "20",
        "10",
        "10",
        "12",
        "4",
        "10",
        "14",
        "8",
        "8",
        "6",
        "5",
        "28",
        "7",
        "5",
        "17",
        "13",
        "14",
        "30",
        "17",
        "13",
        "23",
        "19",
        "14",
        "25",
        "9",
        "16",
        "7",
        "8",
        "10",
        "18",
        "15",
        "9",
        "27",
        "5",
        "32",
        "10",
        "17",
        "9",
        "10",
        "18",
        "24",
        "8",
        "4",
        "16",
        "4",
        "13",
        "5",
        "1.88",
        "1.91",
        "1.10",
        "2.25",
        "2.55",
        "2.74",
        "3.99",
        "2.99",
        "1.02",
        "3.48",
        "2.18",
        "1.32",
        "3.71",
        "1.94",
        "3.84",
        "2.34",
        "2.13",
        "1.84",
        "1.51",
        "5.37",
        "3.20",
        "4.89",
        "1.69",
        "1.01",
        "0.86",
        "1.73",
        "4.06",
        "1.47",
        "3.46",
        "3.49",
        "1.54",
        "1.43",
        "1.97",
        "2.43",
        "2.22",
        "2.71",
        "2.70",
        "2.18",
        "1.55",
        "3.32"
      )
    ),
    class = c("tbl_df",
              "tbl", "data.frame"),
    row.names = c(NA,-201L)
  ))
})

test_that("get_col_values() gets values of a column in a list of tables", {
  expect_equal({
    lpt <- divide(ft_set_h_v)
    get_col_values(lpt, col = 1, start_row = 4)
  }, structure(
    list(
      label = c(
        "b1",
        "",
        "",
        "",
        "Total b1",
        "b2",
        "",
        "",
        "",
        "",
        "Total b2",
        "b3",
        "",
        "",
        "",
        "Total b3",
        "b4",
        "",
        "",
        "",
        "",
        "Total b4",
        "Total general",
        "b1",
        "",
        "",
        "",
        "Total b1",
        "b2",
        "",
        "",
        "",
        "",
        "Total b2",
        "b3",
        "",
        "",
        "",
        "",
        "Total b3",
        "b4",
        "",
        "",
        "",
        "",
        "Total b4",
        "Total general",
        "b1",
        "",
        "",
        "",
        "",
        "Total b1",
        "b2",
        "",
        "",
        "",
        "",
        "Total b2",
        "b3",
        "",
        "",
        "",
        "",
        "Total b3",
        "b4",
        "",
        "",
        "",
        "",
        "Total b4",
        "Total general",
        "b1",
        "",
        "",
        "",
        "",
        "Total b1",
        "b4",
        "",
        "",
        "",
        "",
        "Total b4",
        "Total general"
      ),
      table = c(
        1L,
        1L,
        1L,
        1L,
        1L,
        1L,
        1L,
        1L,
        1L,
        1L,
        1L,
        1L,
        1L,
        1L,
        1L,
        1L,
        1L,
        1L,
        1L,
        1L,
        1L,
        1L,
        1L,
        2L,
        2L,
        2L,
        2L,
        2L,
        2L,
        2L,
        2L,
        2L,
        2L,
        2L,
        2L,
        2L,
        2L,
        2L,
        2L,
        2L,
        2L,
        2L,
        2L,
        2L,
        2L,
        2L,
        2L,
        3L,
        3L,
        3L,
        3L,
        3L,
        3L,
        3L,
        3L,
        3L,
        3L,
        3L,
        3L,
        3L,
        3L,
        3L,
        3L,
        3L,
        3L,
        3L,
        3L,
        3L,
        3L,
        3L,
        3L,
        3L,
        4L,
        4L,
        4L,
        4L,
        4L,
        4L,
        4L,
        4L,
        4L,
        4L,
        4L,
        4L,
        4L
      )
    ),
    class = "data.frame",
    row.names = c(NA,-85L)
  ))
})
